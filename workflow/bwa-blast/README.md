# blast / bwa

Using Blast and bwa are sequence aligners in a high throughput workload.

## Purpose
Benchmark the platform's performance, particularly its capacity to support a high throughput workflow which is frequently executed in AgResearch.

## Installation

Create a Conda environment based on the provided environment specification file and then activate the environment before building and running the benchmark.

```
$ mkdir -p $BWA_BLAST_CONDA_ENV
$ conda-env create -p $BWA_BLAST_CONDA_ENV -f $BWA_BLAST_CONDA_ENV_SPEC
$ conda activate $BWA_BLAST_CONDA_ENV
```

## Setup

The workflow is managed by `snakemake` and it has been setup to offload individual tasks to a cluster for execution.  The benchmark execution script also assume the target cluster is manged by Slrum.  To customise attributes passed to Slurm in job submission, please update `cluster.json` accordingly.

## Execution

Activate the Conda environment created for this benchmark then run the shell script, *run-blast-bwa-benchmark*, to launch the benchmark.

```
$ $BENCHMARK_SOURCE/workflow/bwa-blast/run-bwa-blast-benchmark
```

### Output verification

Check the md5sum of two files generated by the benchmark:

```
$ md5sum $OUTPUT_DATA_ROOT_DIR/bwa-blast/blast_md5sum.txt $OUTPUT_DATA_ROOT_DIR/bwa-blast/sam_file_counts.txt
```

and its output should be like the following:

```
d0ffbb96c530af513222f87deb513700  blast_md5sum.txt
9b4496663acf8040d205ac8a5ce124b2  sam_file_counts.txt
```
